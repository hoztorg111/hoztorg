"use strict";!function(p,t,i){var r,e,s,l=p(t),o={syntax:'<div class="ik_select_link"><div class="ik_select_link_text"></div></div><div class="ik_select_dropdown"><div class="ik_select_list"></div></div>',autoWidth:!0,ddFullWidth:!0,equalWidths:!0,dynamicWidth:!1,extractLink:!1,customClass:"",linkCustomClass:"",ddCustomClass:"",ddMaxHeight:200,filter:!1,nothingFoundText:"Nothing found",isDisabled:!1,onInit:function(){},onShow:function(){},onHide:function(){},onKeyUp:function(){},onKeyDown:function(){},onHoverMove:function(){}};function n(t,i){var e,s={};for(e in this.el=t,this.$el=p(t),o)s[e]=this.$el.data(e.toLowerCase());this.options=p.extend({},o,i,s),p.browser.mobile&&(this.options.filter=!1),this.init()}p.browser||(s={},(e=function(t){t=t.toLowerCase();t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}}(navigator.userAgent)).browser&&(s[e.browser]=!0,s.version=e.version),s.chrome?s.webkit=!0:s.webkit&&(s.safari=!0),p.browser=s),p.browser.mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile/i.test(navigator.userAgent),p.browser.operamini="[object OperaMini]"===Object.prototype.toString.call(t.operamini),p.extend(n.prototype,{init:function(){this.$wrapper=p('<div class="ik_select">'+this.options.syntax+"</div>"),this.$link=p(".ik_select_link",this.$wrapper),this.$linkText=p(".ik_select_link_text",this.$wrapper),this.$dropdown=p(".ik_select_dropdown",this.$wrapper),this.$list=p(".ik_select_list",this.$wrapper),this.$listInner=p('<div class="ik_select_list_inner"/>'),this.$active=p([]),this.$hover=p([]),this.hoverIndex=0,this.$optionSet=p([]),this.$optgroupSet=p([]),this.$list.append(this.$listInner),this.options.filter&&(this.$filter=p([]),this.$optionSetOriginal=p([]),this.$nothingFoundText=p('<div class="ik_select_nothing_found"/>').html(this.options.nothingFoundText),this.$filterWrap=p(".ik_select_filter_wrap",this.$wrapper),this.$filterWrap.length||(this.$filterWrap=p('<div class="ik_select_filter_wrap"/>')),this.$filter=p('<input type="text" class="ik_select_filter">'),this.$filterWrap.append(this.$filter),this.$list.prepend(this.$filterWrap),this.$filter.on({"keydown.ikSelect keyup.ikSelect":p.proxy(this,"_elKeyUpDown"),"keyup.ikSelect":p.proxy(this,"_filterKeyup")})),this.$wrapper.addClass(this.options.customClass),this.$link.addClass(this.options.linkCustomClass||this.options.customClass&&this.options.customClass+"-link"),this.$dropdown.addClass(this.options.ddCustomClass||this.options.customClass&&this.options.customClass+"-dd"),this.reset(),this.toggle(!(this.options.isDisabled||this.$el.prop("disabled")||this.$el.hasClass("hidden"))),this.$link.on("click.ikSelect",p.proxy(this,"_linkClick")),this.$el.on({"focus.ikSelect":p.proxy(this,"_elFocus"),"blur.ikSelect":p.proxy(this,"_elBlur"),"change.ikSelect":p.proxy(this,"_syncOriginalOption"),"keydown.ikSelect keyup.ikSelect":p.proxy(this,"_elKeyUpDown")}),this.$list.on({"click.ikSelect":p.proxy(this,"_optionClick"),"mouseover.ikSelect":p.proxy(this,"_optionMouseover")},".ik_select_option"),this.$wrapper.on("click",function(){return!1}),this.$el.after(this.$wrapper),this.redraw(),this.$el.appendTo(this.$wrapper),this.options.onInit(this),this.$el.trigger("ikinit",this)},_linkClick:function(){this.isDisabled||(this===r?this.hideDropdown():this.showDropdown())},_optionClick:function(){this._makeOptionActive(this.searchIndexes?this.$optionSetOriginal.index(this.$hover):this.hoverIndex,!0),this.hideDropdown(),this.$el.change().focus()},_optionMouseover:function(t){t=p(t.currentTarget);t.hasClass("ik_select_option_disabled")||(this.$hover.removeClass("ik_select_hover"),this.$hover=t.addClass("ik_select_hover"),this.hoverIndex=this.$optionSet.index(this.$hover))},_makeOptionActive:function(t,i){var e=p(this.el.options[t]),s="";e.data("img_src")&&(s+='<span class="icon_color" style="background: url('+e.data("img_src")+')"></span>',this.$link.addClass("img")),e.attr("title")&&this.$link.attr("title",e.attr("title")),s+=e.text(),this.$linkText.html(s),this.$link.toggleClass("ik_select_link_novalue",!e.attr("value")),this.$hover.removeClass("ik_select_hover"),this.$active.removeClass("ik_select_active"),this.$hover=this.$active=this.$optionSet.eq(t).addClass("ik_select_hover ik_select_active"),this.hoverIndex=t,i&&this._syncFakeOption()},_elKeyUpDown:function(t){var i,e=p(t.currentTarget),s=t.type,o=t.which;switch(o){case 38:"keydown"===s&&(t.preventDefault(),this._moveToPrevActive());break;case 40:"keydown"===s&&(t.preventDefault(),this._moveToNextActive());break;case 33:"keydown"===s&&(t.preventDefault(),i=this.$hover.position().top-this.$listInner.height(),this._moveToPrevActive(function(t){return t<=i}));break;case 34:"keydown"===s&&(t.preventDefault(),i=this.$hover.position().top+this.$listInner.height(),this._moveToNextActive(function(t){return i<=t}));break;case 36:"keydown"===s&&e.is(this.$el)&&(t.preventDefault(),this._moveToFirstActive());break;case 35:"keydown"===s&&e.is(this.$el)&&(t.preventDefault(),this._moveToLastActive());break;case 32:"keydown"===s&&e.is(this.$el)&&(t.preventDefault(),this.$dropdown.is(":visible")?this.$hover.click():this._linkClick());break;case 13:"keydown"===s&&this.$dropdown.is(":visible")&&(t.preventDefault(),this.$hover.click());break;case 27:"keydown"===s&&this.$dropdown.is(":visible")&&(t.preventDefault(),this.hideDropdown());break;case 9:"keydown"===s&&(p.browser.webkit&&this.$dropdown.is(":visible")?t.preventDefault():this.hideDropdown());break;default:"keyup"===s&&e.is(this.$el)&&this._syncOriginalOption()}"keyup"===s&&p.browser.mozilla&&this._syncFakeOption(),"keydown"===s&&(this.options.onKeyDown(this,o),this.$el.trigger("ikkeydown",[this,o])),"keyup"===s&&(this.options.onKeyUp(this,o),this.$el.trigger("ikkeyup",[this,o]))},_moveTo:function(t){var i,e;if(!this.$dropdown.is(":visible")&&p.browser.webkit)return this.showDropdown(),this;!this.$dropdown.is(":visible")||p.browser.mozilla?this._makeOptionActive(t,!0):(this.$hover.removeClass("ik_select_hover"),this.$hover=this.$optionSet.eq(t).addClass("ik_select_hover"),this.hoverIndex=t),e=(i=this.$hover.position().top)+this.$active.outerHeight(),this.$hover.index()||(t=this.$hover.closest(".ik_select_optgroup")).length&&(i=t.position().top),e>this.$listInner.height()?this.$listInner.scrollTop(this.$listInner.scrollTop()+e-this.$listInner.height()):i<0&&this.$listInner.scrollTop(this.$listInner.scrollTop()+i),this.options.onHoverMove(this),this.$el.trigger("ikhovermove",this)},_moveToFirstActive:function(){for(var t=0;t<this.$optionSet.length;t++)if(!this.$optionSet.eq(t).hasClass("ik_select_option_disabled")){this._moveTo(t);break}},_moveToLastActive:function(){for(var t=this.$optionSet.length-1;0<=t;t++)if(!this.$optionSet.eq(t).hasClass("ik_select_option_disabled")){this._moveTo(t);break}},_moveToPrevActive:function(t){for(var i,e=this.hoverIndex-1;0<=e;e--)if(!(i=this.$optionSet.eq(e)).hasClass("ik_select_option_disabled")&&(void 0===t||t(i.position().top))){this._moveTo(e);break}},_moveToNextActive:function(t){for(var i,e=this.hoverIndex+1;e<this.$optionSet.length;e++)if(!(i=this.$optionSet.eq(e)).hasClass("ik_select_option_disabled")&&(void 0===t||t(i.position().top))){this._moveTo(e);break}},_elFocus:function(){var t,i,e,s;if(this.isDisabled)return this;this.$link.addClass("ik_select_link_focus"),t=this.$wrapper.offset().top,i=this.$wrapper.height(),((e=l.scrollTop())+(s=l.height())<t+i||t<e)&&l.scrollTop(t-s/2)},_elBlur:function(){this.$link.removeClass("ik_select_link_focus")},_filterKeyup:function(){var t,e=p.trim(this.$filter.val());this.$listInner.show(),void 0===this.searchIndexes&&(this.$optionSetOriginal=this.$optionSet,this.searchIndexes=p.makeArray(this.$optionSet.map(function(t,i){return p(i).text().toLowerCase()}))),e!==t&&(""===e?(this.$optionSet=this.$optionSetOriginal.show(),this.$optgroupSet.show(),this.$nothingFoundText.remove()):(this.$optionSet=p([]),this.$optgroupSet.show(),this.$optionSetOriginal.each(p.proxy(function(t,i){i=p(i);0<=this.searchIndexes[t].indexOf(e.toLowerCase())?(this.$optionSet=this.$optionSet.add(i),i.show()):i.hide()},this)),this.$optionSet.length?(this.$nothingFoundText.remove(),this.$optgroupSet.each(function(t,i){i=p(i);p(".ik_select_option:visible",i).length||i.hide()}),this.$hover.is(":visible")||this._moveToFirstActive()):(this.$listInner.hide(),this.$list.append(this.$nothingFoundText))))},_syncFakeOption:function(){this.el.selectedIndex=this.hoverIndex},_syncOriginalOption:function(){this._makeOptionActive(this.el.selectedIndex)},_fixHeight:function(){this.$dropdown.show(),this.$listInner.css("height","auto"),this.$listInner.height()>this.options.ddMaxHeight&&this.$listInner.css({overflow:"auto",height:this.options.ddMaxHeight,position:"relative"}),this.$dropdown.hide()},redraw:function(){var t,i;this.options.filter&&this.$filter.hide(),this.$wrapper.css({position:"relative"}),this.$dropdown.css({position:"absolute",zIndex:9998,width:"100%"}),this.$list.css({position:"relative"}),this._fixHeight(),(this.options.dynamicWidth||this.options.autoWidth||this.options.ddFullWidth)&&(this.$wrapper.width(""),this.$dropdown.show().width(9999),this.$listInner.css("float","left"),this.$list.css("float","left"),t=this.$list.outerWidth(!0),i=this.$listInner.width()-this.$listInnerUl.width(),this.$list.css("float",""),this.$listInner.css("float",""),this.$dropdown.css("width","100%"),this.options.ddFullWidth&&this.$dropdown.width(t+i),this.options.dynamicWidth?this.$wrapper.css({display:"inline-block",width:"auto",verticalAlign:"top"}):this.options.autoWidth&&this.$wrapper.width(t+(this.options.equalWidths?i:0)).addClass("ik_select_autowidth"),i=this.$wrapper.parent().width(),this.$wrapper.width()>i&&this.$wrapper.width(i)),this.options.filter&&this.$filter.show().outerWidth(this.$filterWrap.width()),this.$dropdown.hide(),this.$el.css({position:"absolute",margin:0,padding:0,top:0,left:-9999}),p.browser.mobile&&this.$el.css({opacity:0,left:0,height:this.$wrapper.height(),width:this.$wrapper.width()})},reset:function(){var o="";this.$linkText.html(this.$el.val()),this.$listInner.empty(),o="<ul>",this.$el.children().each(p.proxy(function(t,i){var e=p(i),s=i.tagName.toLowerCase();"optgroup"===s?(i=e.children().map(p.proxy(function(t,i){return this._generateOptionObject(p(i))},this)),i=p.makeArray(i),o+=this._renderListOptgroup({label:e.attr("label")||"&nbsp;",isDisabled:e.is(":disabled"),options:i})):"option"===s&&(o+=this._renderListOption(this._generateOptionObject(e)))},this)),o+="</ul>",this.$listInner.append(o),this._syncOriginalOption(),this.$listInnerUl=p("> ul",this.$listInner),this.$optgroupSet=p(".ik_select_optgroup",this.$listInner),this.$optionSet=p(".ik_select_option",this.$listInner)},hideDropdown:function(){this.options.filter&&(this.$filter.val(""),this._filterKeyup()),this.$dropdown.hide().appendTo(this.$wrapper).css({left:"",top:""}),this.options.extractLink&&(this.$wrapper.outerWidth(this.$wrapper.data("outerWidth")),this.$wrapper.height(""),this.$link.removeClass("ik_select_link_extracted").css({position:"",top:"",left:"",zIndex:""}).prependTo(this.$wrapper)),r=null,this.$el.focus(),this.options.onHide(this),this.$el.trigger("ikhide",this)},showDropdown:function(){var t,i,e,s,o,n,h;r!==this&&this.$optionSet.length&&(r&&r.hideDropdown(),this._syncOriginalOption(),p(".show_un_props").length?this.$dropdown.addClass("show_un_props"):p(".unshow_un_props").length&&this.$dropdown.addClass("unshow_un_props"),this.$dropdown.show(),e=this.$dropdown.offset(),t=this.$dropdown.outerWidth(!0),h=this.$dropdown.outerHeight(!0),i=this.$wrapper.offset(),s=l.width(),o=l.height(),n=l.scrollTop(),this.options.ddFullWidth&&i.left+t>s&&(e.left=s-t),e.top+h>n+o&&(e.top=n+o-h),this.$dropdown.css({left:e.left,top:e.top,width:this.$dropdown.width()}).appendTo("body"),this.options.extractLink&&(h=this.$link.offset(),e=this.$wrapper.outerWidth(),this.$wrapper.data("outerWidth",e),this.$wrapper.outerWidth(e),this.$wrapper.outerHeight(this.$wrapper.outerHeight()),this.$link.outerWidth(this.$link.outerWidth()),this.$link.addClass("ik_select_link_extracted").css({position:"absolute",top:h.top,left:h.left,zIndex:9999}).appendTo("body")),this.$listInner.scrollTop(this.$active.position().top-this.$list.height()/2),(this.options.filter?this.$filter:this.$el).focus(),(r=this).options.onShow(this),this.$el.trigger("ikshow",this))},_generateOptionObject:function(t){return{value:t.val(),label:t.html()||"&nbsp;",isDisabled:t.is(":disabled"),dataParam:t.data(),className:t.attr("class"),title:t.attr("title")}},_renderListOption:function(t){var i=t.isDisabled?" ik_select_option_disabled":"",e=t.dataParam.img_src?" img":"",s="hidden"==t.className?" missing":"",o=t.title,s='<li class="ik_select_option'+i+e+s+'" title="'+o+'" data-value="'+t.value+'">';return s+='<span class="ik_select_option_label" title="'+o+'">',t.dataParam.img_src&&(s+='<span class="icon_color" style="background: url('+t.dataParam.img_src+')"></span>'),s+=t.label,s+="</span>",s+="</li>"},_renderListOptgroup:function(t){var e='<li class="ik_select_optgroup'+(t.isDisabled?" ik_select_optgroup_disabled":"")+'">';return e+='<div class="ik_select_optgroup_label">'+t.label+"</div>",e+="<ul>",p.isArray(t.options)&&p.each(t.options,p.proxy(function(t,i){e+=this._renderListOption({value:i.value,label:i.label||"&nbsp;",isDisabled:i.isDisabled})},this)),e+="</ul>",e+="</li>"},_renderOption:function(t){return'<option value="'+t.value+'">'+t.label+"</option>"},_renderOptgroup:function(t){var e='<optgroup label="'+t.label+'">';return p.isArray(t.options)&&p.each(t.options,p.proxy(function(t,i){e+=this._renderOption(i)},this)),e+="</option>"},addOptions:function(t,i,e){var s,o,n="",h="",r=this.$listInnerUl,l=this.$el;t=p.isArray(t)?t:[t],p.each(t,p.proxy(function(t,i){n+=this._renderListOption(i),h+=this._renderOption(i)},this)),p.isNumeric(e)&&e<this.$optgroupSet.length&&(r=this.$optgroupSet.eq(e),l=p("optgroup",this.$el).eq(e)),p.isNumeric(i)&&i<(s=p(".ik_select_option",r)).length&&(s.eq(i).before(n),(o=p("option",l)).eq(i).before(h)),o||(r.append(n),l.append(h)),this.$optionSet=p(".ik_select_option",this.$listInner),this._fixHeight()},addOptgroups:function(t,i){var e="",s="";t&&(t=p.isArray(t)?t:[t],p.each(t,p.proxy(function(t,i){e+=this._renderListOptgroup(i),s+=this._renderOptgroup(i)},this)),p.isNumeric(i)&&i<this.$optgroupSet.length?(this.$optgroupSet.eq(i).before(e),p("optgroup",this.$el).eq(i).before(s)):(this.$listInnerUl.append(e),this.$el.append(s)),this.$optgroupSet=p(".ik_select_optgroup",this.$listInner),this.$optionSet=p(".ik_select_option",this.$listInner),this._fixHeight())},removeOptions:function(t,i){var e,s,o=p([]);p.isNumeric(i)&&(i<0?(e=p("> .ik_select_option",this.$listInnerUl),s=p("> option",this.$el)):i<this.$optgroupSet.length&&(e=p(".ik_select_option",this.$optgroupSet.eq(i)),s=p("optgroup",this.$el).eq(i).find("option"))),e||(e=this.$optionSet,s=p(this.el.options)),p.isArray(t)||(t=[t]),p.each(t,p.proxy(function(t,i){i<e.length&&(o=o.add(e.eq(i)).add(s.eq(i)))},this)),o.remove(),this.$optionSet=p(".ik_select_option",this.$listInner),this._syncOriginalOption(),this._fixHeight()},removeOptgroups:function(t){var e=p([]),s=p("optgroup",this.el);p.isArray(t)||(t=[t]),p.each(t,p.proxy(function(t,i){i<this.$optgroupSet.length&&(e=e.add(this.$optgroupSet.eq(i)).add(s.eq(i)))},this)),e.remove(),this.$optionSet=p(".ik_select_option",this.$listInner),this.$optgroupSet=p(".ik_select_optgroup",this.$listInner),this._syncOriginalOption(),this._fixHeight()},disable:function(){this.toggle(!1)},enable:function(){this.toggle(!0)},toggle:function(t){this.isDisabled=void 0!==t?!t:!this.isDisabled,this.$el.prop("disabled",this.isDisabled),this.$link.toggleClass("ik_select_link_disabled",this.isDisabled)},select:function(t,i){i?this.el.selectedIndex=t:this.$el.val(t),this._syncOriginalOption()},disableOptgroups:function(t){this.toggleOptgroups(t,!1)},enableOptgroups:function(t){this.toggleOptgroups(t,!0)},toggleOptgroups:function(t,l){p.isArray(t)||(t=[t]),p.each(t,p.proxy(function(t,i){var e=[],s=p("optgroup",this.$el).eq(i),o=void 0!==l?l:s.prop("disabled");s.prop("disabled",!o),this.$optgroupSet.eq(i).toggleClass("ik_select_optgroup_disabled",!o);for(var n,h=p("option",s),r=n=p(this.el.options).index(h.eq(0));r<n+h.length;r++)e.push(r);this.toggleOptions(e,!0,o)},this)),this._syncOriginalOption()},disableOptions:function(t,i){this.toggleOptions(t,i,!1)},enableOptions:function(t,i){this.toggleOptions(t,i,!0)},toggleOptions:function(t,i,s){var o=p("option",this.el);p.isArray(t)||(t=[t]);var n=p.proxy(function(t,i){var e=void 0!==s?s:t.prop("disabled");t.prop("disabled",!e),this.$optionSet.eq(i).toggleClass("ik_select_option_disabled",!e)},this);p.each(t,function(t,e){i?n(o.eq(e),e):o.each(function(t,i){i=p(i);if(i.val()===e)return n(i,t),this})}),this._syncOriginalOption()},detach:function(){this.$el.off(".ikSelect").css({width:"",height:"",left:"",top:"",position:"",margin:"",padding:""}),this.$wrapper.before(this.$el),this.$wrapper.remove(),this.$el.removeData("plugin_ikSelect")}}),p.fn.ikSelect=function(i){var e;return p.browser.operamini?this:(e=Array.prototype.slice.call(arguments,1),this.each(function(){var t;p.data(this,"plugin_ikSelect")?"string"==typeof i&&"function"==typeof(t=p.data(this,"plugin_ikSelect"))[i]&&t[i].apply(t,e):p.data(this,"plugin_ikSelect",new n(this,i))}))},p.ikSelect={extendDefaults:function(t){p.extend(o,t)}},p(i).bind("click.ikSelect",function(){r&&r.hideDropdown()})}(jQuery,window,document);
//# sourceMappingURL=jquery.ikSelect.min.js.map
